<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Kelly Chang,rasca0027@gmail.com"><title>Jenkins Tutorial pt.1 - Installing Jenkins on Ubuntu 18.04 and Setup · Azimuth</title><meta name="description" content="Prerequisites:Install Java 8.Note the version number! If you directly install the default jdk, it won’t be 8! 
123sudo apt updatesudo apt install open"><meta name="keywords" content="Hexo,LeetCode,Linux,GameDesign,GameDev"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">Azimuth</a></h3><div class="description"><p>Dev Diaries</p></div></div></div><ul class="social-links"><li><a href="https://twitter.com/rasca0027"><i class="fa fa-twitter"></i></a></li><li><a href="http://instagram.com/rasca0027"><i class="fa fa-instagram"></i></a></li><li><a href="http://github.com/rasca0027"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">Home</a></li><li><a href="/about">About</a></li><li><a href="/archives">Archive</a></li><li><a href="/links">Links</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/favicon.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Jenkins Tutorial pt.1 - Installing Jenkins on Ubuntu 18.04 and Setup</a></h3></div><div class="post-content"><h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites:"></a>Prerequisites:</h2><h3 id="Install-Java-8"><a href="#Install-Java-8" class="headerlink" title="Install Java 8."></a>Install Java 8.</h3><p>Note the version number! If you directly install the default jdk, it won’t be 8! </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install openjdk-8-jdk</span><br><span class="line">java -version</span><br></pre></td></tr></table></figure>
<h3 id="Install-Docker"><a href="#Install-Docker" class="headerlink" title="Install Docker"></a>Install Docker</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install apt-transport-https ca-certificates curl software-properties-common</span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line">sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install docker-ce</span><br></pre></td></tr></table></figure>
<p>Check if it’s running by:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl status docker</span><br></pre></td></tr></table></figure></p>
<h2 id="Installing-Jenkins"><a href="#Installing-Jenkins" class="headerlink" title="Installing Jenkins"></a>Installing Jenkins</h2><p>Now we can finally install Jenkins.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget -q -O - https://pkg.jenkins.io/debian/jenkins.io.key | sudo apt-key add -</span><br><span class="line">sudo sh -c &apos;echo deb http://pkg.jenkins.io/debian-stable binary/ &gt; /etc/apt/sources.list.d/jenkins.list&apos;</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install jenkins</span><br></pre></td></tr></table></figure></p>
<p>Next steps we will start Jenkins and set it up.  </p>
<h3 id="Make-sure-jenkins-can-execute-docker-without-sudo"><a href="#Make-sure-jenkins-can-execute-docker-without-sudo" class="headerlink" title="Make sure jenkins can execute docker without sudo"></a>Make sure jenkins can execute docker without sudo</h3><p>Then we have to configure docker so that it is managed by non-root user, and we don’t have to type <code>sudo</code> everytime.<br>To do this, we create a new group and add the jenkins user.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo usermod -aG docker jenkins</span><br></pre></td></tr></table></figure></p>
<h2 id="Start-Jenkins"><a href="#Start-Jenkins" class="headerlink" title="Start Jenkins"></a>Start Jenkins</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start jenkins</span><br><span class="line">sudo systemctl status jenkins</span><br><span class="line">``` </span><br><span class="line">If everything is fine, you will see something like:</span><br></pre></td></tr></table></figure>
<p>● jenkins.service - LSB: Start Jenkins at boot time<br>   Loaded: loaded (/etc/init.d/jenkins; generated)<br>   Active: active (exited) since Tue 2018-11-27 22:28:53 UTC; 2min 23s ago<br>     Docs: man:systemd-sysv-generator(8)<br>    Tasks: 0 (limit: 1152)<br>   CGroup: /system.slice/jenkins.service</p>
<p>Nov 27 22:28:51  systemd[1]: Starting LSB: Start Jenkins at boot time…<br>Nov 27 22:28:51  jenkins[11630]: Correct java version found<br>Nov 27 22:28:52  jenkins[11630]:  * Starting Jenkins Automation Server jenkins<br>Nov 27 22:28:52  su[11676]: Successful su for jenkins by root<br>Nov 27 22:28:52  su[11676]: + ??? root:jenkins<br>Nov 27 22:28:52  su[11676]: pam_unix(su:session): session opened for user jenkins<br>Nov 27 22:28:52  su[11676]: pam_unix(su:session): session closed for user jenkins<br>Nov 27 22:28:53  jenkins[11630]:    …done.<br>Nov 27 22:28:53  systemd[1]: Started LSB: Start Jenkins at boot time.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">If you are seeing errors related to wrong Java version, check the first step of this article.  </span><br><span class="line"></span><br><span class="line">Now you can go to `http://domain or ip:8080` to see your Jenkins app.</span><br><span class="line">You will need to copy and paste the password to prove that you are the owner of this server.</span><br></pre></td></tr></table></figure></p>
<p>sudo cat /var/lib/jenkins/secrets/initialAdminPassword<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Now you will be able to log in and create admin users and stuff. </span><br><span class="line">Next I will build a Django + docker project as an example.</span><br><span class="line"></span><br><span class="line">## Creating our First Pipeline</span><br><span class="line">Now assume I have a project on github. I want to create a pipeline to checkout the source code and do something with it.  </span><br><span class="line"></span><br><span class="line">First create a new job. In the select panel, select `pipeline`.  </span><br><span class="line">For now, we will head directly to the Pipeline section. In the script part, enter following:</span><br></pre></td></tr></table></figure></p>
<p>pipeline {<br>    agent any<br>    environment {<br>    }<br>    stages {<br>        stage(“Hello”) {<br>            steps {<br>                sh ‘echo “Hello World”‘<br>            }<br>        }<br>        stage(“Checkout”) {<br>            steps {<br>                    git branch: ‘master’,<br>                        credentialsId: ‘github’,<br>                        url: ‘<a href="https://github.com/user123/example.git&#39;" target="_blank" rel="noopener">https://github.com/user123/example.git&#39;</a><br>            }<br>        }<br>    }<br>}<br><code>`</code><br>Since this is our first test, we will just do something really simple.  </p>
<p>We are going to test if the pipeline script works, so I’m just gonna put in <code>echo &quot;Hello World&quot;</code> in shell script. If everything works well, we will see this in console logs.  </p>
<p>Next is checking out source code.<br>In this case, I am using github, so I have to input my credentials for github in <code>jenkins &gt; Credentials &gt; Global &gt; Add Credentials</code>.<br>Choose the one with username and password, input your github credentials, and give it ID <code>github</code>.<br>Remember, if you are using the username and password authentication, you have to use the HTTPS url for<br> github instead of the SSH one. The <code>credentialsId</code> in script is the ID that we have for credentials.  </p>
<p>Now save and go back to the item page, and click “Build Now”. If the grid box turns green, it mean your pipeline has successfully built and run.  </p>
<p>Congratulations! You’ve built your first Jenkins pipeline! Now move on to the 2nd part of this tutorial.  </p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2018-11-27</span><i class="fa fa-tag"></i><a class="tag" href="/tags/jenkins-devops/" title="jenkins, devops">jenkins, devops </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" href="http://twitter.com/home?status=,http://rasca0027.github.io/2018/11/27/Installing-Jenkins-on-Ubuntu-18-04-and-Setup/,Azimuth,Jenkins Tutorial pt.1 - Installing Jenkins on Ubuntu 18.04 and Setup,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2018/12/04/Jenkins-docker-tutorial/" title="Jenkins Tutorial pt.2 -  Setup Docker build pipeline and deploy on servers">Previous Post</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2018/10/30/How-to-detach-an-EBS-volume-and-re-attach-to-another-machine/" title="Useful Commands when Fixing EBS in EC2">Next Post</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>